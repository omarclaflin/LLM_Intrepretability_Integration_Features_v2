2025-06-20 00:55:41,203 - root - INFO - Secondary Features argument provided: 4067,4022,3520,899,2020
2025-06-20 00:55:41,203 - root - INFO - Analyzing Secondary features: [4067, 4022, 3520, 899, 2020]
2025-06-20 00:55:41,203 - root - INFO - Model path: ../models/open_llama_3b
2025-06-20 00:55:41,204 - root - INFO - Primary SAE path: ./checkpoints_topk/best_model.pt
2025-06-20 00:55:41,204 - root - INFO - NFM path: ./checkpoints_nfm/best_nfm_linear_interaction_model.pt
2025-06-20 00:55:41,204 - root - INFO - Secondary SAE path: ./interaction_sae/best_interaction_sae_topk_model.pt
2025-06-20 00:55:41,204 - root - INFO - Number of examples per feature: 20
2025-06-20 00:55:41,204 - root - INFO - Number of dataset samples: 10000
2025-06-20 00:55:41,204 - root - INFO - Batch size: 16
2025-06-20 00:55:41,204 - root - INFO - Run clamping interventions: True
2025-06-20 00:55:41,205 - root - INFO - Max token length: 10
2025-06-20 00:55:41,205 - root - INFO - Claude examples: 20
2025-06-20 00:55:41,205 - root - INFO - Claude API key loaded successfully
2025-06-20 00:55:41,205 - root - INFO - Loading models...
2025-06-20 00:55:41,558 - root - INFO - Set pad_token to eos_token for tokenizer
2025-06-20 00:55:43,809 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-06-20 00:55:48,017 - root - INFO - Loading Primary SAE model...
2025-06-20 00:55:48,360 - root - INFO - Loading Primary TopK SAE model...
2025-06-20 00:55:50,632 - root - INFO - Loading NFM model...
2025-06-20 00:55:50,889 - root - INFO - Creating NFM with num_features=50000, k_dim=200, output_dim=3200
2025-06-20 00:55:51,888 - root - INFO - Loading Secondary TopK SAE model...
2025-06-20 00:55:51,912 - root - INFO - Loading wikitext dataset with chunking...
2025-06-20 00:55:58,164 - root - INFO - Loaded 10000 text samples from wikitext-103 (max_token_length=10)
2025-06-20 00:55:58,164 - root - INFO - 
Analyzing Secondary SAE feature 4067
2025-06-20 00:55:58,164 - root - INFO - Finding top 20 examples...
2025-06-20 00:57:30,969 - root - INFO - Computing Secondary feature statistics...
2025-06-20 00:57:46,850 - root - INFO - Statistics: {'mean_activation': 0.46351173520088196, 'max_activation': 0.9871066212654114, 'median_activation': 0.4602280855178833, 'percent_active': 100.0, 'feature_idx': 4067}
2025-06-20 00:57:46,850 - root - INFO - Finding contributing Primary SAE features...
2025-06-20 00:57:50,917 - root - INFO - Creating visualizations...
2025-06-20 00:57:55,468 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 00:57:57,497 - root - INFO - Identified pattern: that
2025-06-20 00:57:57,498 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 00:58:25,262 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 00:58:26,650 - root - INFO - Incremental results saved for Secondary feature 4067
2025-06-20 00:58:26,650 - root - INFO - 
Analyzing Secondary SAE feature 4022
2025-06-20 00:58:26,651 - root - INFO - Finding top 20 examples...
2025-06-20 00:59:55,686 - root - INFO - Computing Secondary feature statistics...
2025-06-20 01:00:10,661 - root - INFO - Statistics: {'mean_activation': 1.1848039627075195, 'max_activation': 2.767932415008545, 'median_activation': 1.1737757921218872, 'percent_active': 100.0, 'feature_idx': 4022}
2025-06-20 01:00:10,661 - root - INFO - Finding contributing Primary SAE features...
2025-06-20 01:00:14,732 - root - INFO - Creating visualizations...
2025-06-20 01:00:19,126 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 01:00:27,679 - root - INFO - Identified pattern: that
2025-06-20 01:00:27,679 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 01:00:48,413 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 01:00:50,889 - root - INFO - Incremental results saved for Secondary feature 4022
2025-06-20 01:00:50,889 - root - INFO - 
Analyzing Secondary SAE feature 3520
2025-06-20 01:00:50,889 - root - INFO - Finding top 20 examples...
2025-06-20 01:02:05,629 - root - INFO - Computing Secondary feature statistics...
2025-06-20 01:02:20,475 - root - INFO - Statistics: {'mean_activation': 0.0, 'max_activation': 0.0, 'median_activation': 0.0, 'percent_active': 0.0, 'feature_idx': 3520}
2025-06-20 01:02:20,476 - root - INFO - Finding contributing Primary SAE features...
2025-06-20 01:02:21,433 - root - INFO - Creating visualizations...
2025-06-20 01:02:21,696 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 01:02:24,306 - root - INFO - Identified pattern: Rhyme
2025-06-20 01:02:24,306 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 01:02:41,844 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 01:02:44,401 - root - INFO - Incremental results saved for Secondary feature 3520
2025-06-20 01:02:44,402 - root - INFO - 
Analyzing Secondary SAE feature 899
2025-06-20 01:02:44,402 - root - INFO - Finding top 20 examples...
2025-06-20 01:04:11,799 - root - INFO - Computing Secondary feature statistics...
2025-06-20 01:04:27,290 - root - INFO - Statistics: {'mean_activation': 0.09768225252628326, 'max_activation': 0.8137221336364746, 'median_activation': 0.023844093084335327, 'percent_active': 54.75, 'feature_idx': 899}
2025-06-20 01:04:27,291 - root - INFO - Finding contributing Primary SAE features...
2025-06-20 01:04:31,305 - root - INFO - Creating visualizations...
2025-06-20 01:04:32,738 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 01:04:36,542 - root - INFO - Identified pattern: Squares
2025-06-20 01:04:36,542 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 01:05:01,194 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 01:05:05,146 - root - INFO - Incremental results saved for Secondary feature 899
2025-06-20 01:05:05,146 - root - INFO - 
Analyzing Secondary SAE feature 2020
2025-06-20 01:05:05,147 - root - INFO - Finding top 20 examples...
2025-06-20 01:06:36,755 - root - INFO - Computing Secondary feature statistics...
2025-06-20 01:06:52,307 - root - INFO - Statistics: {'mean_activation': 0.5837916135787964, 'max_activation': 2.2578694820404053, 'median_activation': 0.5643384456634521, 'percent_active': 89.2, 'feature_idx': 2020}
2025-06-20 01:06:52,307 - root - INFO - Finding contributing Primary SAE features...
2025-06-20 01:06:56,433 - root - INFO - Creating visualizations...
2025-06-20 01:07:00,893 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 01:07:03,668 - root - INFO - Identified pattern: Parentheses
2025-06-20 01:07:03,668 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 01:07:35,415 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 01:07:40,693 - root - INFO - Incremental results saved for Secondary feature 2020
2025-06-20 01:07:40,694 - root - INFO - Creating summary report...
2025-06-20 01:07:40,695 - root - INFO - Secondary SAE analysis complete! Results saved to secondary_feature_analysis\secondary_feature_meaning_FIXED_20250620_005541
