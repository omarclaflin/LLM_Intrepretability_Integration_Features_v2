2025-06-20 00:37:42,492 - root - INFO - Secondary Features argument provided: 4067,4022,3520,899,2020
2025-06-20 00:37:42,492 - root - INFO - Analyzing Secondary features: [4067, 4022, 3520, 899, 2020]
2025-06-20 00:37:42,492 - root - INFO - Model path: ../models/open_llama_3b
2025-06-20 00:37:42,492 - root - INFO - Primary SAE path: ./checkpoints_topk/best_model.pt
2025-06-20 00:37:42,492 - root - INFO - NFM path: ./checkpoints_nfm/best_nfm_linear_interaction_model.pt
2025-06-20 00:37:42,492 - root - INFO - Secondary SAE path: ./interaction_sae/best_interaction_sae_topk_model.pt
2025-06-20 00:37:42,493 - root - INFO - Number of examples per feature: 20
2025-06-20 00:37:42,493 - root - INFO - Number of dataset samples: 10000
2025-06-20 00:37:42,493 - root - INFO - Batch size: 16
2025-06-20 00:37:42,493 - root - INFO - Run clamping interventions: True
2025-06-20 00:37:42,493 - root - INFO - Max token length: 10
2025-06-20 00:37:42,493 - root - INFO - Claude examples: 20
2025-06-20 00:37:42,493 - root - INFO - Claude API key loaded successfully
2025-06-20 00:37:42,494 - root - INFO - Loading models...
2025-06-20 00:37:42,844 - root - INFO - Set pad_token to eos_token for tokenizer
2025-06-20 00:37:45,040 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-06-20 00:37:49,216 - root - INFO - Loading Primary SAE model...
2025-06-20 00:37:49,533 - root - INFO - Loading Primary TopK SAE model...
2025-06-20 00:37:51,752 - root - INFO - Loading NFM model...
2025-06-20 00:37:51,976 - root - INFO - Creating NFM with num_features=50000, k_dim=200, output_dim=3200
2025-06-20 00:37:52,883 - root - INFO - Loading Secondary TopK SAE model...
2025-06-20 00:37:52,900 - root - INFO - Loading wikitext dataset with chunking...
2025-06-20 00:37:59,041 - root - INFO - Loaded 10000 text samples from wikitext-103 (max_token_length=10)
2025-06-20 00:37:59,041 - root - INFO - 
Analyzing Secondary SAE feature 4067
2025-06-20 00:37:59,041 - root - INFO - Finding top 20 examples...
2025-06-20 00:39:12,836 - root - INFO - Computing Secondary feature statistics...
2025-06-20 00:39:27,627 - root - INFO - Statistics: {'mean_activation': 0.0, 'max_activation': 0.0, 'median_activation': 0.0, 'percent_active': 0.0, 'feature_idx': 4067}
2025-06-20 00:39:27,628 - root - INFO - Creating visualizations...
2025-06-20 00:39:27,628 - root - WARNING - No examples to visualize for Secondary feature 4067
2025-06-20 00:39:27,628 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 00:39:27,629 - secondary_feature_id - WARNING - No valid examples to send to Claude for Secondary feature 4067 identification.
2025-06-20 00:39:27,629 - root - INFO - Identified pattern: Unknown pattern (No valid examples)
2025-06-20 00:39:27,629 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 00:39:58,653 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 00:39:58,654 - root - INFO - Incremental results saved for Secondary feature 4067
2025-06-20 00:39:58,654 - root - INFO - 
Analyzing Secondary SAE feature 4022
2025-06-20 00:39:58,655 - root - INFO - Finding top 20 examples...
2025-06-20 00:41:14,193 - root - INFO - Computing Secondary feature statistics...
2025-06-20 00:41:30,225 - root - INFO - Statistics: {'mean_activation': 0.0, 'max_activation': 0.0, 'median_activation': 0.0, 'percent_active': 0.0, 'feature_idx': 4022}
2025-06-20 00:41:30,226 - root - INFO - Creating visualizations...
2025-06-20 00:41:30,226 - root - WARNING - No examples to visualize for Secondary feature 4022
2025-06-20 00:41:30,226 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 00:41:30,226 - secondary_feature_id - WARNING - No valid examples to send to Claude for Secondary feature 4022 identification.
2025-06-20 00:41:30,226 - root - INFO - Identified pattern: Unknown pattern (No valid examples)
2025-06-20 00:41:30,226 - root - INFO - Running FIXED Secondary SAE clamping interventions...
2025-06-20 00:42:01,751 - root - INFO - Secondary SAE clamping results obtained (FIXED implementation)
2025-06-20 00:42:01,752 - root - INFO - Incremental results saved for Secondary feature 4022
2025-06-20 00:42:01,752 - root - INFO - 
Analyzing Secondary SAE feature 3520
2025-06-20 00:42:01,753 - root - INFO - Finding top 20 examples...
2025-06-20 00:43:19,196 - root - INFO - Computing Secondary feature statistics...
2025-06-20 00:43:35,091 - root - INFO - Statistics: {'mean_activation': 0.0, 'max_activation': 0.0, 'median_activation': 0.0, 'percent_active': 0.0, 'feature_idx': 3520}
2025-06-20 00:43:35,092 - root - INFO - Creating visualizations...
2025-06-20 00:43:35,092 - root - WARNING - No examples to visualize for Secondary feature 3520
2025-06-20 00:43:35,092 - root - INFO - Identifying Secondary feature pattern using Claude API...
2025-06-20 00:43:35,092 - secondary_feature_id - WARNING - No valid examples to send to Claude for Secondary feature 3520 identification.
2025-06-20 00:43:35,092 - root - INFO - Identified pattern: Unknown pattern (No valid examples)
2025-06-20 00:43:35,092 - root - INFO - Running FIXED Secondary SAE clamping interventions...
